<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACCT 302 - Practice Exam 1</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .header {
            text-align: center;
            background: linear-gradient(135deg, #1a237e, #3949ab);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2em;
        }
        .header p {
            margin: 5px 0;
            opacity: 0.9;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        button {
            padding: 12px 25px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        .refresh-btn {
            background: linear-gradient(135deg, #43a047, #66bb6a);
            color: white;
        }
        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(67, 160, 71, 0.4);
        }
        .show-answers-btn {
            background: linear-gradient(135deg, #1565c0, #42a5f5);
            color: white;
        }
        .show-answers-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(21, 101, 192, 0.4);
        }
        .hide-answers-btn {
            background: linear-gradient(135deg, #ef6c00, #ffa726);
            color: white;
        }
        .question {
            background: white;
            padding: 20px 25px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-left: 4px solid #3949ab;
        }
        .question-number {
            font-weight: bold;
            color: #1a237e;
            font-size: 1.1em;
        }
        .question-text {
            margin: 15px 0;
            font-size: 1.05em;
        }
        .options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 15px;
        }
        .option {
            display: block;
            margin: 0;
            padding: 12px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            background-color: #fafafa;
            border: 1px solid #e0e0e0;
        }
        .option:hover {
            background-color: #e3f2fd;
            border-color: #90caf9;
        }
        .option.selected {
            background-color: #e3f2fd;
            border-color: #1976d2;
        }
        .option.correct {
            background-color: #c8e6c9;
            border-color: #43a047;
        }
        .option.incorrect {
            background-color: #ffcdd2;
            border-color: #e53935;
        }
        .option input {
            margin-right: 12px;
            transform: scale(1.2);
            vertical-align: middle;
        }
        .option-text {
            vertical-align: middle;
        }
        .answer {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-radius: 8px;
            border-left: 4px solid #43a047;
        }
        .answer.show {
            display: block;
        }
        .answer-label {
            font-weight: bold;
            color: #2e7d32;
        }
        .explanation {
            margin-top: 10px;
            color: #555;
            font-size: 0.95em;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.95em;
        }
        .data-table th, .data-table td {
            border: 1px solid #ddd;
            padding: 10px 12px;
            text-align: left;
        }
        .data-table th {
            background-color: #e3f2fd;
            font-weight: 600;
        }
        .data-table tr:nth-child(even) {
            background-color: #fafafa;
        }
        .section-header {
            background: linear-gradient(135deg, #5e35b1, #7e57c2);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 30px 0 20px 0;
            font-size: 1.2em;
            font-weight: 600;
        }
        .info-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        .score-display {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: none;
        }
        .score-display.show {
            display: block;
        }
        .score-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #1a237e;
        }
        .submit-section {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .submit-btn {
            background: linear-gradient(135deg, #d32f2f, #f44336);
            color: white;
            padding: 15px 40px;
            font-size: 18px;
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(211, 47, 47, 0.4);
        }
        .grade-result {
            display: none;
            margin-top: 20px;
            padding: 25px;
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-radius: 10px;
            text-align: center;
        }
        .grade-result.show {
            display: block;
        }
        .grade-percentage {
            font-size: 3em;
            font-weight: bold;
            color: #2e7d32;
            margin-bottom: 10px;
        }
        .grade-letter {
            font-size: 2em;
            font-weight: bold;
            color: #1a237e;
            margin-bottom: 10px;
        }
        .grade-details {
            font-size: 1.1em;
            color: #555;
        }
        .grade-result.failing {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
        }
        .grade-result.failing .grade-percentage {
            color: #c62828;
        }
        .unanswered-warning {
            color: #e65100;
            font-weight: bold;
            margin-top: 10px;
        }
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            .header h1 {
                font-size: 1.5em;
            }
            .question {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ACCT 302 - Cost Accounting</h1>
        <p><strong>Practice Exam 1</strong></p>
        <p>Chapters 1, 2, 3, 4, 5</p>
    </div>
    
    <div class="controls">
        <button class="refresh-btn" onclick="generateExam()">üîÑ New Exam (Shuffle & Randomize)</button>
        <button class="show-answers-btn" onclick="toggleAnswers()">üìù Show/Hide Answers</button>
    </div>
    
    <div class="score-display" id="scoreDisplay">
        <div class="score-number" id="scoreNumber">0/38</div>
        <p>Questions Answered Correctly</p>
    </div>
    
    <div id="examContent"></div>

    <script>
        let answersVisible = false;
        let currentExamData = {};
        
        // Utility functions
        function shuffle(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }
        
        function randInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        function randChoice(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }
        
        function formatCurrency(num) {
            return '$' + num.toLocaleString();
        }
        
        function formatNumber(num) {
            return num.toLocaleString();
        }

        // Question generators
        const questions = [
            // Q1 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "It is prepared based on cost-benefit analysis.", correct: false },
                        { text: "It is primarily used by managers to make internal business decisions.", correct: false },
                        { text: "It focuses on the past-oriented financial performance of a company.", correct: true },
                        { text: "It only measures the cash transactions of a company.", correct: false }
                    ];
                    return {
                        question: "Which of the following is true of financial accounting information?",
                        options: shuffle(options),
                        explanation: "Financial accounting focuses on past-oriented financial performance for external users."
                    };
                }
            },
            // Q2 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "The primary users of cost accounting are the investors, whereas the primary users of financial accounting are the managers.", correct: false },
                        { text: "Cost accounting deals with product design, production, and marketing strategies, whereas financial accounting deals mainly with pricing of the products.", correct: false },
                        { text: "Cost accounting measures only the financial information related to the costs of acquiring fixed assets in an organization, whereas financial accounting measures financial and nonfinancial information of a company's business transactions.", correct: false },
                        { text: "Cost accounting measures information related to the costs of acquiring or using resources in an organization, whereas financial accounting measures a financial position of a company to investors, banks, and external parties.", correct: true }
                    ];
                    return {
                        question: "Which of the following differentiates cost accounting and financial accounting?",
                        options: shuffle(options),
                        explanation: "Cost accounting is for internal use measuring resource costs; financial accounting is for external parties measuring financial position."
                    };
                }
            },
            // Q3 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "C A E B D", correct: true },
                        { text: "C D B E A", correct: false },
                        { text: "E D A B C", correct: false },
                        { text: "A E B D C", correct: false }
                    ];
                    return {
                        question: `Place the five steps in the decision-making process in the correct order:<br><br>
                        A = Obtain information<br>
                        B = Make decisions by choosing among alternatives<br>
                        C = Identify the problem and uncertainties<br>
                        D = Implement the decision, evaluate performance, and learn<br>
                        E = Make predictions about the future`,
                        options: shuffle(options),
                        explanation: "The correct order is: Identify problem (C) ‚Üí Obtain information (A) ‚Üí Make predictions (E) ‚Üí Make decisions (B) ‚Üí Implement and evaluate (D)"
                    };
                }
            },
            // Q4 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "It helps an organization to select goals and strategies.", correct: true },
                        { text: "It improves the quality of products.", correct: false },
                        { text: "It helps in evaluating performance.", correct: false },
                        { text: "It helps in the analysis of actual performance.", correct: false }
                    ];
                    return {
                        question: "Which of the following is true of planning in decision making?",
                        options: shuffle(options),
                        explanation: "Planning helps organizations select goals and strategies for the future."
                    };
                }
            },
            // Q5 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "A budget is a qualitative expression of a plan.", correct: false },
                        { text: "The process of preparing a budget does not encourage coordination and communication throughout the company.", correct: false },
                        { text: "A budget helps to control activities by adhering to the prescribed plan.", correct: true },
                        { text: "A budget can only be used as a planning tool.", correct: false }
                    ];
                    return {
                        question: "Choose a correct statement:",
                        options: shuffle(options),
                        explanation: "A budget is a quantitative expression of a plan and helps control activities."
                    };
                }
            },
            // Q6 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "the process of tracking both direct and indirect costs associated with a cost object", correct: false },
                        { text: "the process of determining the opportunity cost of a cost object chosen", correct: false },
                        { text: "the assignment of indirect costs to the chosen cost object", correct: true },
                        { text: "made based on material acquisition document", correct: false }
                    ];
                    return {
                        question: "Cost allocation is:",
                        options: shuffle(options),
                        explanation: "Cost allocation is specifically the assignment of indirect costs to cost objects."
                    };
                }
            },
            // Q7 - Calculation
            {
                type: 'calculation',
                generate: function() {
                    const dm = randInt(6, 12) * 10; // 60-120
                    const dml = randInt(3, 6) * 10; // 30-60
                    const voh = randInt(3, 6) * 10; // 30-60
                    const foh = randInt(2, 5) * 10; // 20-50
                    const commission = randInt(5, 10); // 5-10
                    const admin = randInt(15, 25); // 15-25
                    
                    const productCost = dm + dml + voh + foh;
                    const total = productCost + commission + admin;
                    
                    const wrongAnswers = [
                        dm + dml + voh, // missing fixed OH
                        dm + dml + voh + foh + commission, // includes commission
                        dm + dml // only direct costs
                    ];
                    
                    const options = [
                        { text: formatCurrency(productCost), correct: true },
                        { text: formatCurrency(wrongAnswers[0]), correct: false },
                        { text: formatCurrency(wrongAnswers[1]), correct: false },
                        { text: formatCurrency(wrongAnswers[2]), correct: false }
                    ];
                    
                    return {
                        question: `Tuffy Apparels is a clothing manufacturer. Unit costs associated with one of its products, Product FGS1156 are as follows:<br><br>
                        <table class="data-table">
                            <tr><td>Direct materials</td><td>${formatCurrency(dm)}</td></tr>
                            <tr><td>Direct manufacturing labor</td><td>${formatCurrency(dml)}</td></tr>
                            <tr><td>Variable manufacturing overhead</td><td>${formatCurrency(voh)}</td></tr>
                            <tr><td>Fixed manufacturing overhead</td><td>${formatCurrency(foh)}</td></tr>
                            <tr><td>Sales commissions (2% of sales)</td><td>${formatCurrency(commission)}</td></tr>
                            <tr><td>Administrative salaries</td><td>${formatCurrency(admin)}</td></tr>
                            <tr><th>Total</th><th>${formatCurrency(total)}</th></tr>
                        </table>
                        What are the product costs per unit associated with Product FGS1156?`,
                        options: shuffle(options),
                        explanation: `Product cost = ${formatCurrency(dm)} + ${formatCurrency(dml)} + ${formatCurrency(voh)} + ${formatCurrency(foh)} = ${formatCurrency(productCost)}<br>
                        (Product costs include all manufacturing costs: DM + DL + MOH. Sales commissions and admin salaries are period costs.)`
                    };
                }
            },
            // Q8 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "costs incurred to provide customer service such as the operation of an 800 phone line to trouble shoot product problems and to answer questions about product warranties", correct: true },
                        { text: "the cost of materials used to make a product when those materials are an insignificant part of the finished product", correct: false },
                        { text: "the cost of direct labor", correct: false },
                        { text: "the amount of depreciation expense recognized because of the use of plant assets such as building and equipment", correct: false }
                    ];
                    return {
                        question: "Which of the following is a period cost?",
                        options: shuffle(options),
                        explanation: "Customer service costs are period costs (non-manufacturing). Materials and depreciation of plant assets are product costs."
                    };
                }
            },
            // Q9 - Calculation
            {
                type: 'calculation',
                generate: function() {
                    const begWIP = randInt(12, 20) * 1000; // 12000-20000
                    const endWIP = randInt(4, 8) * 1000; // 4000-8000
                    const mfgCost = randInt(60, 80) * 1000; // 60000-80000
                    const endFG = randInt(6, 12) * 1000; // 6000-12000
                    
                    const cogm = begWIP + mfgCost - endWIP;
                    
                    const wrongAnswers = [
                        mfgCost - endWIP, // forgot beg WIP
                        mfgCost + endWIP, // added instead of subtracted end WIP
                        cogm - endFG // subtracted FG
                    ];
                    
                    const options = [
                        { text: formatCurrency(cogm), correct: true },
                        { text: formatCurrency(wrongAnswers[0]), correct: false },
                        { text: formatCurrency(wrongAnswers[1]), correct: false },
                        { text: formatCurrency(wrongAnswers[2]), correct: false }
                    ];
                    
                    return {
                        question: `Lakers Company has the following information for the year:<br><br>
                        <table class="data-table">
                            <tr><th></th><th>Beginning Balance</th><th>Ending Balance</th></tr>
                            <tr><td>Work in Process</td><td>${formatCurrency(begWIP)}</td><td>${formatCurrency(endWIP)}</td></tr>
                            <tr><td>Finished Goods</td><td>$0</td><td>${formatCurrency(endFG)}</td></tr>
                        </table>
                        Lakers' manufacturing cost for the year is ${formatCurrency(mfgCost)}. How much would the Cost of Goods Manufactured be for this year?`,
                        options: shuffle(options),
                        explanation: `COGM = Beg. WIP + Manufacturing cost - Ending WIP<br>
                        = ${formatCurrency(begWIP)} + ${formatCurrency(mfgCost)} - ${formatCurrency(endWIP)} = ${formatCurrency(cogm)}`
                    };
                }
            },
            // Q10 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "the total revenue line starts at the origin and the total costs line starts at the fixed intercept", correct: true },
                        { text: "the operating income line starts at the origin and the total costs line starts at the fixed intercept", correct: false },
                        { text: "the breakeven point is at the fixed intercept where the total revenues line intersects", correct: false },
                        { text: "the operating income area is the section where the total costs line is above the total revenues line", correct: false }
                    ];
                    return {
                        question: "In the graph method of CVP analysis:",
                        options: shuffle(options),
                        explanation: "In CVP graphs, revenue starts at origin (0 sales = 0 revenue), and total costs start at the fixed cost intercept."
                    };
                }
            },
            // Q11 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "the variable cost per unit increases", correct: false },
                        { text: "the total fixed costs decrease", correct: true },
                        { text: "the contribution margin per unit decreases", correct: false },
                        { text: "the selling price per unit decreases", correct: false }
                    ];
                    return {
                        question: "The breakeven point decreases if:",
                        options: shuffle(options),
                        explanation: "BEP = Fixed Costs / CM per unit. Lower fixed costs or higher CM reduces BEP."
                    };
                }
            },
            // Q12 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "reports gross margin", correct: false },
                        { text: "is allowed for external reporting to shareholders", correct: false },
                        { text: "categorizes costs as either direct or indirect", correct: false },
                        { text: "can be used to predict operating income at different levels of activity", correct: true }
                    ];
                    return {
                        question: "The contribution margin income statement ________.",
                        options: shuffle(options),
                        explanation: "CM income statement separates variable and fixed costs, allowing prediction of income at different activity levels."
                    };
                }
            },
            // Q13 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "revenues equal fixed costs", correct: false },
                        { text: "revenues equal variable costs", correct: false },
                        { text: "contribution margin equals total costs", correct: false },
                        { text: "revenues equal the sum of variable and fixed costs", correct: true }
                    ];
                    return {
                        question: "The breakeven point is the activity level where:",
                        options: shuffle(options),
                        explanation: "At BEP: Revenue - Variable Costs - Fixed Costs = 0, so Revenue = Variable Costs + Fixed Costs"
                    };
                }
            },
            // Q14 - Calculation
            {
                type: 'calculation',
                generate: function() {
                    const price = randInt(18, 25); // selling price
                    const dm = randInt(5, 8); // direct material
                    const dml = Math.round(randInt(15, 25) / 10 * 10) / 10; // direct labor 1.5-2.5
                    const moh = 0.5; // manufacturing overhead
                    const selling = 2; // selling cost
                    const units = randInt(10, 15) * 1000; // 10000-15000
                    const fixedCost = randInt(80, 120) * 1000; // 80000-120000
                    
                    const cmBefore = (price - dm - dml - moh - selling) * units;
                    const increase = 1; // increase by $1 each
                    const cmAfter = (price - (dm + increase) - (dml + increase) - moh - selling) * units;
                    const change = cmAfter - cmBefore; // will be negative (decrease)
                    
                    const options = [
                        { text: `increases by ${formatCurrency(Math.abs(change))}`, correct: false },
                        { text: `increases by ${formatCurrency(Math.abs(change)/2)}`, correct: false },
                        { text: `decreases by ${formatCurrency(Math.abs(change))}`, correct: true },
                        { text: `decreases by ${formatCurrency(Math.abs(change)/2)}`, correct: false }
                    ];
                    
                    return {
                        question: `Orion Company sells several products. Information of average revenue and costs is as follows:<br><br>
                        <table class="data-table">
                            <tr><td>Selling price per unit</td><td>${formatCurrency(price)}</td></tr>
                            <tr><td colspan="2"><strong>Variable costs per unit:</strong></td></tr>
                            <tr><td>&nbsp;&nbsp;Direct material</td><td>${formatCurrency(dm)}</td></tr>
                            <tr><td>&nbsp;&nbsp;Direct manufacturing labor</td><td>$${dml.toFixed(2)}</td></tr>
                            <tr><td>&nbsp;&nbsp;Manufacturing overhead</td><td>$${moh.toFixed(2)}</td></tr>
                            <tr><td>&nbsp;&nbsp;Selling costs</td><td>${formatCurrency(selling)}</td></tr>
                            <tr><td>Annual fixed costs</td><td>${formatCurrency(fixedCost)}</td></tr>
                        </table>
                        The company sells ${formatNumber(units)} units at the end of the year.<br><br>
                        If direct labor and direct material costs increase by $1 each, contribution margin:`,
                        options: shuffle(options),
                        explanation: `Original CM per unit = $${price} - $${dm} - $${dml.toFixed(2)} - $${moh.toFixed(2)} - $${selling} = $${(price - dm - dml - moh - selling).toFixed(2)}<br>
                        New CM per unit = Original - $2 = $${(price - dm - dml - moh - selling - 2).toFixed(2)}<br>
                        Change = $2 √ó ${formatNumber(units)} = ${formatCurrency(Math.abs(change))} decrease`
                    };
                }
            },
            // Q15 - Calculation
            {
                type: 'calculation',
                generate: function() {
                    // Pick tax rate that divides evenly
                    const taxRates = [0.20, 0.25, 0.28, 0.30, 0.32, 0.35, 0.40];
                    const taxRate = randChoice(taxRates);
                    
                    // Pick target operating income that when multiplied by (1-tax) gives round number
                    const targetOI = randInt(15, 30) * 100000; // 1,500,000 to 3,000,000
                    const targetNI = Math.round(targetOI * (1 - taxRate));
                    
                    const wrongAnswers = [
                        Math.round(targetNI * (1 - taxRate)),
                        targetNI,
                        Math.round(targetNI * (1 + taxRate))
                    ];
                    
                    const options = [
                        { text: formatCurrency(wrongAnswers[0]), correct: false },
                        { text: formatCurrency(targetNI), correct: false },
                        { text: formatCurrency(targetOI), correct: true },
                        { text: formatCurrency(wrongAnswers[2]), correct: false }
                    ];
                    
                    return {
                        question: `If a company's target net income is ${formatCurrency(targetNI)} and the tax rate is ${(taxRate * 100).toFixed(0)}%, what is the target operating income?`,
                        options: shuffle(options),
                        explanation: `Target Operating Income = Target Net Income / (1 - Tax Rate)<br>
                        = ${formatCurrency(targetNI)} / (1 - ${taxRate}) = ${formatCurrency(targetNI)} / ${(1-taxRate).toFixed(2)} = ${formatCurrency(targetOI)}`
                    };
                }
            },
            // Q16 - Calculation
            {
                type: 'calculation',
                generate: function() {
                    const units = randInt(15, 25) * 1000; // 15000-25000
                    const cmPerUnit = randInt(12, 20); // CM per unit
                    const sales = units * randInt(50, 80); // sales revenue
                    const vcRatio = randChoice([0.70, 0.72, 0.75, 0.78, 0.80]);
                    const vc = Math.round(sales * vcRatio);
                    const actualCM = sales - vc;
                    const actualCMPerUnit = actualCM / units;
                    
                    const fixedCosts = randInt(20, 30) * 10000; // 200,000-300,000
                    const taxRate = 0.30;
                    
                    // Calculate after-tax income target that gives clean unit answer
                    const cmPU = actualCMPerUnit;
                    const targetUnits = Math.round((fixedCosts + 100000) / cmPU); // target around this
                    const targetOI = targetUnits * cmPU - fixedCosts;
                    const targetNI = Math.round(targetOI * (1 - taxRate));
                    
                    // Recalculate properly
                    const oiTarget = Math.round(targetNI / (1 - taxRate));
                    const unitsNeeded = Math.round((fixedCosts + oiTarget) / cmPU);
                    
                    const wrongAnswers = [
                        Math.round((fixedCosts + targetNI) / cmPU),
                        Math.round(fixedCosts / cmPU),
                        unitsNeeded - 2000
                    ];
                    
                    const options = [
                        { text: `${formatNumber(unitsNeeded)} units`, correct: true },
                        { text: `${formatNumber(wrongAnswers[0])} units`, correct: false },
                        { text: `${formatNumber(wrongAnswers[1])} units`, correct: false },
                        { text: `${formatNumber(wrongAnswers[2])} units`, correct: false }
                    ];
                    
                    return {
                        question: `Sparkle Jewelry sells ${formatNumber(units)} units resulting in ${formatCurrency(sales)} of sales revenue, ${formatCurrency(vc)} of variable costs, and ${formatCurrency(fixedCosts)} of fixed costs. Suppose the income tax rate is 30% and the company's goal is to have ${formatCurrency(targetNI)} after-tax net income. How many units does the company need to sell? (Round to the nearest whole unit.)`,
                        options: shuffle(options),
                        explanation: `CM per unit = (${formatCurrency(sales)} - ${formatCurrency(vc)}) / ${formatNumber(units)} = $${cmPU.toFixed(2)}<br>
                        Operating income target = ${formatCurrency(targetNI)} / (1-30%) = ${formatCurrency(oiTarget)}<br>
                        Units needed = (${formatCurrency(fixedCosts)} + ${formatCurrency(oiTarget)}) / $${cmPU.toFixed(2)} = ${formatNumber(unitsNeeded)} units`
                    };
                }
            },
            // Q17 - Calculation
            {
                type: 'calculation',
                generate: function() {
                    const cmRatio = randChoice([0.25, 0.30, 0.35, 0.40]);
                    const targetOI = randInt(50, 80) * 1000; // 50,000-80,000
                    const targetSales = randInt(250, 350) * 1000; // 250,000-350,000
                    
                    // FC = CM - OI = (Sales √ó CMR) - OI
                    const fixedCosts = (targetSales * cmRatio) - targetOI;
                    
                    const wrongAnswers = [
                        targetOI - fixedCosts,
                        targetSales - targetOI,
                        targetSales * cmRatio
                    ];
                    
                    const options = [
                        { text: formatCurrency(Math.abs(wrongAnswers[0])), correct: false },
                        { text: formatCurrency(wrongAnswers[1]), correct: false },
                        { text: formatCurrency(wrongAnswers[2]), correct: false },
                        { text: formatCurrency(fixedCosts), correct: true }
                    ];
                    
                    return {
                        question: `If the contribution margin ratio is ${cmRatio}, targeted operating income is ${formatCurrency(targetOI)}, and targeted sales volume in dollars is ${formatCurrency(targetSales)}, then total fixed costs are:`,
                        options: shuffle(options),
                        explanation: `(Fixed Costs + ${formatCurrency(targetOI)}) / ${cmRatio} = ${formatCurrency(targetSales)}<br>
                        Fixed Costs + ${formatCurrency(targetOI)} = ${formatCurrency(targetSales * cmRatio)}<br>
                        Fixed Costs = ${formatCurrency(fixedCosts)}`
                    };
                }
            },
            // Q18 - Calculation (Sales Mix)
            {
                type: 'calculation',
                generate: function() {
                    const xPrice = randInt(10, 15);
                    const xVC = randInt(3, 6);
                    const yPrice = randInt(40, 50);
                    const yVC = randInt(8, 12);
                    
                    const xCM = xPrice - xVC;
                    const yCM = yPrice - yVC;
                    
                    // Mix: 2 units of X for every 1 unit of Y
                    // Weighted CM = 2*xCM + 1*yCM
                    const weightedCM = 2 * xCM + yCM;
                    
                    // Fixed costs should be divisible by weighted CM
                    const fixedCosts = weightedCM * randInt(1000, 2000);
                    
                    const yUnits = fixedCosts / weightedCM;
                    const xUnits = 2 * yUnits;
                    
                    const options = [
                        { text: `Product X: ${formatNumber(Math.round(xUnits/2))} units, Product Y: ${formatNumber(Math.round(yUnits/2))} units`, correct: false },
                        { text: `Product X: ${formatNumber(yUnits)} units, Product Y: ${formatNumber(xUnits)} units`, correct: false },
                        { text: `Product X: ${formatNumber(xUnits)} units, Product Y: ${formatNumber(yUnits)} units`, correct: true },
                        { text: `Product X: ${formatNumber(xUnits + 500)} units, Product Y: ${formatNumber(yUnits - 250)} units`, correct: false }
                    ];
                    
                    return {
                        question: `Alex Corp has a total fixed cost of ${formatCurrency(fixedCosts)} and has following information for its products:<br><br>
                        <table class="data-table">
                            <tr><th></th><th>Price per unit</th><th>Variable Cost per unit</th></tr>
                            <tr><td>Product X</td><td>$${xPrice.toFixed(2)}</td><td>$${xVC.toFixed(2)}</td></tr>
                            <tr><td>Product Y</td><td>$${yPrice.toFixed(2)}</td><td>$${yVC.toFixed(2)}</td></tr>
                        </table>
                        Assuming the sales mix consists of two units of Product X and one unit of Product Y, what is the breakeven point for Alex?`,
                        options: shuffle(options),
                        explanation: `Let N = units of Product Y, then 2N = units of Product X<br>
                        At breakeven: ($${xPrice.toFixed(2)} - $${xVC.toFixed(2)}) √ó 2N + ($${yPrice.toFixed(2)} - $${yVC.toFixed(2)}) √ó N = ${formatCurrency(fixedCosts)}<br>
                        $${xCM.toFixed(2)} √ó 2N + $${yCM.toFixed(2)} √ó N = ${formatCurrency(fixedCosts)}<br>
                        $${weightedCM.toFixed(2)}N = ${formatCurrency(fixedCosts)}<br>
                        N = ${formatNumber(yUnits)} units (Y), X = ${formatNumber(xUnits)} units`
                    };
                }
            },
            // Q19 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "Cost allocation", correct: true },
                        { text: "Job cost recording", correct: false },
                        { text: "Cost pooling", correct: false },
                        { text: "Cost tracing", correct: false }
                    ];
                    return {
                        question: "________ is the process of assigning indirect costs to products.",
                        options: shuffle(options),
                        explanation: "Cost allocation is assigning indirect costs. Cost tracing is for direct costs."
                    };
                }
            },
            // Q20 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "Job costing is used when each unit of output is identical, and process costing deals with unique products.", correct: false },
                        { text: "Job costing is used when each unit of output is identical and not produced in batches, and process costing deals with unique products produced on large scale.", correct: false },
                        { text: "Process costing is used when each unit of output is identical, and job costing deals with unique products not produced in batches.", correct: true },
                        { text: "Job costing is used by manufacturing industries, and process costing is used by service industries.", correct: false }
                    ];
                    return {
                        question: "Which of the following differentiates job costing from process costing?",
                        options: shuffle(options),
                        explanation: "Process costing = identical/mass production. Job costing = unique/custom products."
                    };
                }
            },
            // Q21 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "using the budgeted direct cost rates times the budgeted quantities of direct-cost inputs", correct: false },
                        { text: "using the actual direct costs rates times the budgeted quantities of the direct-cost inputs", correct: false },
                        { text: "using the actual direct cost rates times the actual quantities of the direct-cost inputs", correct: true },
                        { text: "using the budgeted direct cost rates times the actual quantities of the direct cost inputs", correct: false }
                    ];
                    return {
                        question: "Actual costing is a costing system that traces direct costs to a cost object by:",
                        options: shuffle(options),
                        explanation: "Actual costing uses actual rates √ó actual quantities for both direct and indirect costs."
                    };
                }
            },
            // Q22 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "An oil refining company", correct: true },
                        { text: "A manufacturer of ships", correct: false },
                        { text: "A custom kitchen cabinet company", correct: false },
                        { text: "A consulting firm", correct: false }
                    ];
                    return {
                        question: "Which of the following companies will use a process costing system?",
                        options: shuffle(options),
                        explanation: "Oil refining produces identical, continuous output = process costing. Custom products = job costing."
                    };
                }
            },
            // Q23 - Calculation
            {
                type: 'calculation',
                generate: function() {
                    const dm = randInt(25, 40) * 100; // 2500-4000
                    const laborRate = randInt(20, 30); // per hour
                    const dmlTotal = randInt(20, 30) * 100; // 2000-3000
                    const laborHours = dmlTotal / laborRate;
                    const ohRate = randInt(25, 40); // per labor hour
                    const oh = laborHours * ohRate;
                    const sellingPrice = randInt(80, 120) * 100; // 8000-12000
                    const units = randInt(30, 60); // 30-60 units
                    
                    const unitCost = dm + dmlTotal + oh;
                    const profit = (sellingPrice - unitCost) * units;
                    
                    const wrongAnswers = [
                        (sellingPrice - dm - dmlTotal) * units,
                        profit + 20000,
                        profit - 15000
                    ];
                    
                    const options = [
                        { text: formatCurrency(wrongAnswers[0]), correct: false },
                        { text: formatCurrency(wrongAnswers[1]), correct: false },
                        { text: formatCurrency(profit), correct: true },
                        { text: formatCurrency(Math.abs(wrongAnswers[2])), correct: false }
                    ];
                    
                    return {
                        question: `X-Industries manufactures 3-D printers. For each unit, ${formatCurrency(dm)} of direct material is used and there is ${formatCurrency(dmlTotal)} of direct manufacturing labor at $${laborRate} per hour. Manufacturing overhead is applied at $${ohRate} per direct manufacturing labor hour. Calculate the profit earned on ${units} units if each unit sells for ${formatCurrency(sellingPrice)}.`,
                        options: shuffle(options),
                        explanation: `Labor hours = ${formatCurrency(dmlTotal)} / $${laborRate} = ${laborHours} hours<br>
                        MOH = ${laborHours} hours √ó $${ohRate} = ${formatCurrency(oh)}<br>
                        Unit cost = ${formatCurrency(dm)} + ${formatCurrency(dmlTotal)} + ${formatCurrency(oh)} = ${formatCurrency(unitCost)}<br>
                        Profit = (${formatCurrency(sellingPrice)} - ${formatCurrency(unitCost)}) √ó ${units} = ${formatCurrency(profit)}`
                    };
                }
            },
            // Q24 - Calculation
            {
                type: 'calculation',
                generate: function() {
                    const accountants = randInt(10, 15);
                    const paras = randInt(8, 12);
                    
                    // Budgeted values
                    const budgetAcctSalary = randInt(100, 125) * 1000;
                    const budgetParaSalary = randInt(30, 40) * 1000;
                    const budgetLaborHours = randInt(35, 45) * 1000;
                    const budgetIndirectCosts = randInt(280, 350) * 1000;
                    
                    // Actual values (slightly different from budget)
                    const acctSalary = budgetAcctSalary + randInt(5, 15) * 1000;
                    const paraSalary = budgetParaSalary + randInt(1, 5) * 1000;
                    const totalLaborHours = budgetLaborHours + randInt(5, 15) * 1000;
                    const indirectCosts = budgetIndirectCosts + randInt(10, 30) * 1000;
                    
                    const totalDirectCost = (acctSalary * accountants) + (paraSalary * paras);
                    const directRate = totalDirectCost / totalLaborHours;
                    const indirectRate = indirectCosts / totalLaborHours;
                    
                    const options = [
                        { text: `$${directRate.toFixed(2)}; $${indirectRate.toFixed(2)}`, correct: true },
                        { text: `$${(directRate + 5).toFixed(2)}; $${(indirectRate + 1).toFixed(2)}`, correct: false },
                        { text: `$${(directRate - 3).toFixed(2)}; $${indirectRate.toFixed(2)}`, correct: false },
                        { text: `$${indirectRate.toFixed(2)}; $${directRate.toFixed(2)}`, correct: false }
                    ];
                    
                    return {
                        question: `Smith and Jones CPA firm employs ${accountants} accountants and ${paras} paraprofessionals. Direct and indirect costs are applied on a professional labor-hour basis that includes both accountant and paraprofessional hours. Following is information:<br><br>
                        <table class="data-table">
                            <tr><th></th><th>Budgeted</th><th>Actual</th></tr>
                            <tr><td>Indirect costs</td><td>${formatCurrency(budgetIndirectCosts)}</td><td>${formatCurrency(indirectCosts)}</td></tr>
                            <tr><td>Annual salary of each accountant</td><td>${formatCurrency(budgetAcctSalary)}</td><td>${formatCurrency(acctSalary)}</td></tr>
                            <tr><td>Annual salary of each paraprofessional</td><td>${formatCurrency(budgetParaSalary)}</td><td>${formatCurrency(paraSalary)}</td></tr>
                            <tr><td>Total professional labor-hours</td><td>${formatNumber(budgetLaborHours)} dlh</td><td>${formatNumber(totalLaborHours)} dlh</td></tr>
                        </table>
                        What are the <strong>actual</strong> direct-cost rate and the <strong>actual</strong> indirect-cost rate, respectively, per professional labor-hour?`,
                        options: shuffle(options),
                        explanation: `Actual Direct cost rate = [(${formatCurrency(acctSalary)} √ó ${accountants}) + (${formatCurrency(paraSalary)} √ó ${paras})] / ${formatNumber(totalLaborHours)}<br>
                        = ${formatCurrency(totalDirectCost)} / ${formatNumber(totalLaborHours)} = $${directRate.toFixed(2)}<br>
                        Actual Indirect rate = ${formatCurrency(indirectCosts)} / ${formatNumber(totalLaborHours)} = $${indirectRate.toFixed(2)}`
                    };
                }
            },
            // Q25 - Calculation
            {
                type: 'calculation',
                generate: function() {
                    const companyDM = randInt(60, 80) * 1000;
                    const companyDL = randInt(28, 38) * 1000;
                    const companyOH = randInt(50, 65) * 1000;
                    const companyMH = randInt(80, 120) * 1000;
                    
                    const jobDM = randInt(2000, 3000);
                    const jobDL = randInt(600, 1000);
                    const jobMH = randInt(600, 1000);
                    
                    const ohRate = companyOH / companyMH;
                    const jobOH = jobMH * ohRate;
                    const totalJobCost = jobDM + jobDL + jobOH;
                    
                    const wrongAnswers = [
                        jobDM + jobDL,
                        totalJobCost + 300,
                        totalJobCost - 400
                    ];
                    
                    const options = [
                        { text: formatCurrency(Math.round(wrongAnswers[0])), correct: false },
                        { text: formatCurrency(Math.round(totalJobCost)), correct: true },
                        { text: formatCurrency(Math.round(wrongAnswers[1])), correct: false },
                        { text: formatCurrency(Math.round(wrongAnswers[2])), correct: false }
                    ];
                    
                    return {
                        question: `Lancelot Manufacturing uses machine-hours as the single indirect-cost rate. Estimates for the coming year:<br><br>
                        <table class="data-table">
                            <tr><th></th><th>Company</th><th>Case High School Job</th></tr>
                            <tr><td>Direct materials</td><td>${formatCurrency(companyDM)}</td><td>${formatCurrency(jobDM)}</td></tr>
                            <tr><td>Direct labor</td><td>${formatCurrency(companyDL)}</td><td>${formatCurrency(jobDL)}</td></tr>
                            <tr><td>Manufacturing overhead costs</td><td>${formatCurrency(companyOH)}</td><td></td></tr>
                            <tr><td>Machine-hours</td><td>${formatNumber(companyMH)} mh</td><td>${formatNumber(jobMH)} mh</td></tr>
                        </table>
                        What are the total manufacturing costs of this job?`,
                        options: shuffle(options),
                        explanation: `OH rate = ${formatCurrency(companyOH)} / ${formatNumber(companyMH)} mh = $${ohRate.toFixed(2)} per mh<br>
                        Job OH = ${formatNumber(jobMH)} mh √ó $${ohRate.toFixed(2)} = ${formatCurrency(Math.round(jobOH))}<br>
                        Total = ${formatCurrency(jobDM)} + ${formatCurrency(jobDL)} + ${formatCurrency(Math.round(jobOH))} = ${formatCurrency(Math.round(totalJobCost))}`
                    };
                }
            },
            // Q26 - Calculation (Journal Entry)
            {
                type: 'calculation',
                generate: function() {
                    const sales = randInt(45, 55) * 100000;
                    const ohAllocated = randInt(800, 1200) * 1000;
                    const ohControl = ohAllocated + randInt(300, 600) * 1000; // underapplied
                    const cogs = randInt(30, 40) * 100000;
                    
                    const underapplied = ohControl - ohAllocated;
                    
                    const options = [
                        { text: `Dr. Manufacturing overhead control ${formatCurrency(ohControl)}<br>&nbsp;&nbsp;&nbsp;&nbsp;Cr. Cost of goods sold ${formatCurrency(underapplied)}<br>&nbsp;&nbsp;&nbsp;&nbsp;Cr. Manufacturing overhead allocated ${formatCurrency(ohAllocated)}`, correct: false },
                        { text: `Dr. Sales ${formatCurrency(sales)}<br>&nbsp;&nbsp;&nbsp;&nbsp;Cr. Cost of goods sold ${formatCurrency(cogs)}<br>&nbsp;&nbsp;&nbsp;&nbsp;Cr. Gross profit ${formatCurrency(sales - cogs)}`, correct: false },
                        { text: `Dr. Finished goods ${formatCurrency(underapplied)}<br>Dr. Manufacturing overhead allocated ${formatCurrency(ohAllocated)}<br>&nbsp;&nbsp;&nbsp;&nbsp;Cr. Manufacturing overhead control ${formatCurrency(ohControl)}`, correct: false },
                        { text: `Dr. Cost of goods sold ${formatCurrency(underapplied)}<br>Dr. Manufacturing overhead allocated ${formatCurrency(ohAllocated)}<br>&nbsp;&nbsp;&nbsp;&nbsp;Cr. Manufacturing overhead control ${formatCurrency(ohControl)}`, correct: true }
                    ];
                    
                    return {
                        question: `The Robinson Corporation manufactures automobile parts. At year end, these are the balances:<br><br>
                        <table class="data-table">
                            <tr><td>Cost of goods sold</td><td>${formatCurrency(cogs)}</td></tr>
                            <tr><td>Manufacturing overhead allocated</td><td>${formatCurrency(ohAllocated)}</td></tr>
                            <tr><td>Manufacturing overhead control</td><td>${formatCurrency(ohControl)}</td></tr>
                        </table>
                        What would be the correct journal entry to close out the overhead accounts using the write-off to cost of goods sold approach?`,
                        options: shuffle(options),
                        explanation: `Underapplied OH = ${formatCurrency(ohControl)} - ${formatCurrency(ohAllocated)} = ${formatCurrency(underapplied)}<br>
                        Dr. Cost of goods sold (to increase COGS by underapplied amount)<br>
                        Dr. Manufacturing overhead allocated (to close)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;Cr. Manufacturing overhead control (to close)`
                    };
                }
            },
            // Q27 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "A peanut-butter costing system typically has more-homogeneous indirect cost pools.", correct: false },
                        { text: "A peanut-butter costing system broadly averages or spreads the cost of resources uniformly to cost objects.", correct: true },
                        { text: "A peanut-butter costing system assumes that all costs are variable.", correct: false },
                        { text: "In a peanut-butter costing system, costs of activities are used to assign costs to other cost objects such as products or services based on the activities the products or services consume.", correct: false }
                    ];
                    return {
                        question: "Which of the following statements is true of a peanut-butter costing system?",
                        options: shuffle(options),
                        explanation: "Peanut-butter costing spreads costs uniformly (like spreading peanut butter), leading to potential over/under costing."
                    };
                }
            },
            // Q28 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "While refining a costing system, companies should identify as many indirect costs as is economically feasible.", correct: false },
                        { text: "A homogeneous cost pool will use multiple cost drivers to allocate costs.", correct: false },
                        { text: "It reduces the use of broad averages for assigning the cost of resources to cost objects.", correct: true },
                        { text: "It is likely to yield the most decision-making benefits when direct costs are a high percentage of total costs.", correct: false }
                    ];
                    return {
                        question: "Which of the following is true of refinement of a costing system?",
                        options: shuffle(options),
                        explanation: "Refinement reduces broad averages, providing more accurate cost assignments through ABC."
                    };
                }
            },
            // Q29 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "Factory rent expense", correct: false },
                        { text: "Building security costs", correct: false },
                        { text: "Top management compensation costs", correct: false },
                        { text: "Machine depreciation", correct: true }
                    ];
                    return {
                        question: "________ is an example of an output unit-level cost in the cost hierarchy.",
                        options: shuffle(options),
                        explanation: "Machine depreciation varies with units produced. Rent, security, and top management are facility-level costs."
                    };
                }
            },
            // Q30 - Conceptual
            {
                type: 'conceptual',
                generate: function() {
                    const options = [
                        { text: "DACB", correct: false },
                        { text: "DBCA", correct: false },
                        { text: "BADC", correct: false },
                        { text: "CDAB", correct: true }
                    ];
                    return {
                        question: `Put the following ABC implementation steps in order:<br><br>
                        A = Compute the allocation rates.<br>
                        B = Compute the total cost of the products.<br>
                        C = Identify the products that are the cost objects.<br>
                        D = Select the cost allocation bases.`,
                        options: shuffle(options),
                        explanation: "Order: Identify cost objects (C) ‚Üí Select allocation bases (D) ‚Üí Compute rates (A) ‚Üí Compute total cost (B)"
                    };
                }
            },
            // Q31 - Calculation
            {
                type: 'calculation',
                generate: function() {
                    const total = randInt(24, 32) * 1000;
                    const l3ByDLH = randInt(17, 22) * 1000;
                    const l7ByDLH = total - l3ByDLH;
                    
                    // ABC allocation should be different
                    const diff = randInt(4, 8) * 1000;
                    const l3BySetup = l3ByDLH - diff;
                    const l7BySetup = total - l3BySetup;
                    
                    const options = [
                        { text: `L3 pack is undercosted by ${formatCurrency(diff)}`, correct: false },
                        { text: `L7 pack is undercosted by ${formatCurrency(diff - 100)}`, correct: false },
                        { text: `L3 pack is overcosted by ${formatCurrency(diff)}`, correct: true },
                        { text: `L7 pack is overcosted by ${formatCurrency(diff)}`, correct: false }
                    ];
                    
                    return {
                        question: `Extracts from cost information of Tuffy Corp:<br><br>
                        <table class="data-table">
                            <tr><th></th><th>Simple L3 Pack</th><th>Complex L7 Pack</th><th>Total</th></tr>
                            <tr><td>Setup cost allocated using direct labor-hours</td><td>${formatCurrency(l3ByDLH)}</td><td>${formatCurrency(l7ByDLH)}</td><td>${formatCurrency(total)}</td></tr>
                            <tr><td>Setup cost allocated using setup-hours</td><td>${formatCurrency(l3BySetup)}</td><td>${formatCurrency(l7BySetup)}</td><td>${formatCurrency(total)}</td></tr>
                        </table>
                        Assuming that setup-hours is considered a more effective cost driver for allocating setup costs than direct labor-hours. Which of the following statements is true of Tuffy's setup costs under traditional costing?`,
                        options: shuffle(options),
                        explanation: `Under traditional (DLH): L3 = ${formatCurrency(l3ByDLH)}<br>
                        Under ABC (setup-hours): L3 = ${formatCurrency(l3BySetup)}<br>
                        Difference = ${formatCurrency(l3ByDLH)} - ${formatCurrency(l3BySetup)} = ${formatCurrency(diff)}<br>
                        L3 is overcosted by ${formatCurrency(diff)} under traditional costing.`
                    };
                }
            },
            // Q32-34 - ABC Questions (grouped data)
            {
                type: 'calculation',
                generate: function() {
                    // Generate ABC data
                    const partsHandling = randInt(70, 90) * 10000;
                    const machineCosts = randInt(35, 45) * 10000;
                    const designCost = randInt(48, 60) * 10000;
                    const batchSetup = randInt(18, 25) * 10000;
                    
                    const totalOH = partsHandling + machineCosts + designCost + batchSetup;
                    
                    const aMH = randInt(18, 25) * 1000;
                    const bMH = randInt(8, 12) * 1000;
                    const totalMH = aMH + bMH;
                    
                    const aUnits = 100000;
                    const bUnits = 12000;
                    
                    // Single driver calculation (MH)
                    const ohRatePerMH = totalOH / totalMH;
                    const aOHperUnit = (ohRatePerMH * aMH) / aUnits;
                    
                    const wrongAnswers = [
                        14,
                        aOHperUnit + 2,
                        98
                    ];
                    
                    const options = [
                        { text: `$${aOHperUnit.toFixed(2)}`, correct: true },
                        { text: `$${wrongAnswers[0].toFixed(2)}`, correct: false },
                        { text: `$${wrongAnswers[1].toFixed(2)}`, correct: false },
                        { text: `$${wrongAnswers[2].toFixed(2)}`, correct: false }
                    ];
                    
                    // Store data for Q33 and Q34
                    currentExamData.q32 = {
                        partsHandling, machineCosts, designCost, batchSetup,
                        totalOH, aMH, bMH, totalMH, aUnits, bUnits, ohRatePerMH
                    };
                    
                    return {
                        question: `<div class="info-box"><strong>Use the following information for Questions 32-34:</strong></div>
                        Titan Rock Company makes two products, A and B, and has developed the following overhead cost pools for its ABC system. During 2024, ${formatNumber(aUnits)} units of product A were produced and ${formatNumber(bUnits)} units of product B.<br><br>
                        <table class="data-table">
                            <tr><th>Pool</th><th>Cost in Pool</th><th>Cost Driver</th><th>Usage by A</th><th>Usage by B</th></tr>
                            <tr><td>Parts Handling</td><td>${formatCurrency(partsHandling)}</td><td>Parts Received</td><td>300,000</td><td>100,000</td></tr>
                            <tr><td>Machine costs</td><td>${formatCurrency(machineCosts)}</td><td>Machine hours</td><td>${formatNumber(aMH)}</td><td>${formatNumber(bMH)}</td></tr>
                            <tr><td>Design Cost</td><td>${formatCurrency(designCost)}</td><td>Designer hours</td><td>1,000</td><td>4,000</td></tr>
                            <tr><td>Batch Setup</td><td>${formatCurrency(batchSetup)}</td><td>Batches</td><td>100</td><td>300</td></tr>
                        </table><br>
                        <strong>Question 32:</strong> What is the overhead cost per unit for product A if all overhead is assigned using the single overhead driver of machine hours (to the nearest cent)?`,
                        options: shuffle(options),
                        explanation: `Total OH = ${formatCurrency(partsHandling)} + ${formatCurrency(machineCosts)} + ${formatCurrency(designCost)} + ${formatCurrency(batchSetup)} = ${formatCurrency(totalOH)}<br>
                        Total MH = ${formatNumber(aMH)} + ${formatNumber(bMH)} = ${formatNumber(totalMH)}<br>
                        OH rate = ${formatCurrency(totalOH)} / ${formatNumber(totalMH)} = $${ohRatePerMH.toFixed(2)} per MH<br>
                        OH per unit A = $${ohRatePerMH.toFixed(2)} √ó ${formatNumber(aMH)} / ${formatNumber(aUnits)} = $${aOHperUnit.toFixed(2)}`
                    };
                }
            },
            // Q33
            {
                type: 'calculation',
                generate: function() {
                    const d = currentExamData.q32 || { designCost: 540000 };
                    const designCost = d.designCost || 540000;
                    const totalDesignHours = 5000;
                    const ratePerDesignHour = designCost / totalDesignHours;
                    
                    const wrongAnswers = [
                        500,
                        125,
                        0.10
                    ];
                    
                    const options = [
                        { text: `$${wrongAnswers[0]}`, correct: false },
                        { text: `$${wrongAnswers[1]}`, correct: false },
                        { text: `$${ratePerDesignHour}`, correct: true },
                        { text: `$${wrongAnswers[2].toFixed(2)}`, correct: false }
                    ];
                    
                    return {
                        question: `<strong>Question 33:</strong> What is the overhead cost per designer hour in the design cost pool?`,
                        options: shuffle(options),
                        explanation: `Design cost rate = ${formatCurrency(designCost)} / (1,000 + 4,000) = ${formatCurrency(designCost)} / 5,000 = $${ratePerDesignHour} per designer hour`
                    };
                }
            },
            // Q34
            {
                type: 'calculation',
                generate: function() {
                    const d = currentExamData.q32 || {};
                    const partsHandling = d.partsHandling || 820000;
                    const machineCosts = d.machineCosts || 400000;
                    const designCost = d.designCost || 540000;
                    const batchSetup = d.batchSetup || 200000;
                    const bMH = d.bMH || 10000;
                    
                    // ABC rates and allocation to B
                    const partsRate = partsHandling / 400000;
                    const bParts = partsRate * 100000;
                    
                    const machineRate = machineCosts / (d.totalMH || 30000);
                    const bMachine = machineRate * bMH;
                    
                    const designRate = designCost / 5000;
                    const bDesign = designRate * 4000;
                    
                    const batchRate = batchSetup / 400;
                    const bBatch = batchRate * 300;
                    
                    const totalB = bParts + bMachine + bDesign + bBatch;
                    
                    const wrongAnswers = [
                        653333,
                        1470000,
                        d.totalOH || 1960000
                    ];
                    
                    const options = [
                        { text: formatCurrency(Math.round(totalB)), correct: true },
                        { text: formatCurrency(wrongAnswers[0]), correct: false },
                        { text: formatCurrency(wrongAnswers[1]), correct: false },
                        { text: formatCurrency(wrongAnswers[2]), correct: false }
                    ];
                    
                    return {
                        question: `<strong>Question 34:</strong> How much total overhead would be charged to product B using ABC? (Round rates to nearest cent)`,
                        options: shuffle(options),
                        explanation: `Parts: $${partsRate.toFixed(2)} √ó 100,000 = ${formatCurrency(Math.round(bParts))}<br>
                        Machine: $${machineRate.toFixed(2)} √ó ${formatNumber(bMH)} = ${formatCurrency(Math.round(bMachine))}<br>
                        Design: $${designRate.toFixed(2)} √ó 4,000 = ${formatCurrency(Math.round(bDesign))}<br>
                        Setup: $${batchRate.toFixed(2)} √ó 300 = ${formatCurrency(Math.round(bBatch))}<br>
                        Total = ${formatCurrency(Math.round(totalB))}`
                    };
                }
            },
            // Q35 - Short Answer (Classification)
            {
                type: 'short_answer',
                generate: function() {
                    return {
                        question: `<strong>Short Answer Question 35:</strong> Classify the following costs for an auto manufacturer as either Direct Materials, Direct Labor, Manufacturing Overhead, or Period Costs:<br><br>
                        a. Steel used in automobiles<br>
                        b. Assembly department employee wages<br>
                        c. Glass used in automobiles<br>
                        d. Maintenance supplies<br>
                        e. Plant manager's salary<br>
                        f. CEO's salary`,
                        answer: `<table class="data-table">
                            <tr><th></th><th>Direct Materials</th><th>Direct Labor</th><th>Mfg Overhead</th><th>Period Cost</th></tr>
                            <tr><td>a. Steel</td><td><strong>X</strong></td><td></td><td></td><td></td></tr>
                            <tr><td>b. Assembly wages</td><td></td><td><strong>X</strong></td><td></td><td></td></tr>
                            <tr><td>c. Glass</td><td><strong>X</strong></td><td></td><td></td><td></td></tr>
                            <tr><td>d. Maintenance supplies</td><td></td><td></td><td><strong>X</strong></td><td></td></tr>
                            <tr><td>e. Plant manager</td><td></td><td></td><td><strong>X</strong></td><td></td></tr>
                            <tr><td>f. CEO salary</td><td></td><td></td><td></td><td><strong>X</strong></td></tr>
                        </table>`
                    };
                }
            },
            // Q36-38 - ABC Short Answer
            {
                type: 'short_answer_calc',
                generate: function() {
                    const eqDepn = randInt(80, 95) * 1000;
                    const indLabor = randInt(4, 6) * 1000;
                    
                    // Distribution percentages
                    const machEq = 0.20;
                    const setupEq = 0.50;
                    const otherEq = 0.30;
                    const machLab = 0.20;
                    const setupLab = 0.40;
                    const otherLab = 0.40;
                    
                    const machTotal = (eqDepn * machEq) + (indLabor * machLab);
                    const setupTotal = (eqDepn * setupEq) + (indLabor * setupLab);
                    const otherTotal = (eqDepn * otherEq) + (indLabor * otherLab);
                    
                    const totalMH = 10000;
                    const totalBatches = 1000;
                    
                    const s4MH = randInt(3000, 4500);
                    const c0MH = totalMH - s4MH;
                    const s4Batches = randInt(500, 700);
                    const c0Batches = totalBatches - s4Batches;
                    
                    const machRate = machTotal / totalMH;
                    const setupRate = setupTotal / totalBatches;
                    
                    const c0OH = (machRate * c0MH) + (setupRate * c0Batches);
                    
                    currentExamData.q36 = {
                        eqDepn, indLabor, machTotal, setupTotal, otherTotal,
                        totalMH, totalBatches, s4MH, c0MH, s4Batches, c0Batches,
                        machRate, setupRate, c0OH
                    };
                    
                    return {
                        question: `<div class="info-box"><strong>Use the following information for Questions 36-38:</strong></div>
                        Howell Corporation's activity-based costing system has three activity cost pools‚ÄîMachining, Setting Up, and Other. Overhead costs consist of equipment depreciation and indirect labor allocated to pools in proportion to resource consumption.<br><br>
                        <table class="data-table">
                            <tr><td>Equipment depreciation (total)</td><td>${formatCurrency(eqDepn)}</td></tr>
                            <tr><td>Indirect labor (total)</td><td>${formatCurrency(indLabor)}</td></tr>
                        </table><br>
                        <table class="data-table">
                            <tr><th>Distribution of Resource Consumption</th><th>Machining</th><th>Setting Up</th><th>Other</th></tr>
                            <tr><td>Equipment depreciation</td><td>0.20</td><td>0.50</td><td>0.30</td></tr>
                            <tr><td>Indirect labor</td><td>0.20</td><td>0.40</td><td>0.40</td></tr>
                        </table><br>
                        Machining costs are assigned based on machine-hours (MHs). Setting Up costs are assigned based on batches. Other costs are not assigned.<br><br>
                        <table class="data-table">
                            <tr><th></th><th>MHs</th><th>Batches</th></tr>
                            <tr><td>Product S4</td><td>${formatNumber(s4MH)}</td><td>${s4Batches}</td></tr>
                            <tr><td>Product C0</td><td>${formatNumber(c0MH)}</td><td>${c0Batches}</td></tr>
                            <tr><td><strong>Total</strong></td><td><strong>${formatNumber(totalMH)}</strong></td><td><strong>${totalBatches}</strong></td></tr>
                        </table><br>
                        <strong>Question 36:</strong> What is the total cost assigned to Machining Cost Pool?`,
                        answer: `<table class="data-table">
                            <tr><th></th><th>Machining</th><th>Setting Up</th><th>Other</th><th>Total</th></tr>
                            <tr><td>Equipment depreciation</td><td>${formatCurrency(eqDepn * machEq)}</td><td>${formatCurrency(eqDepn * setupEq)}</td><td>${formatCurrency(eqDepn * otherEq)}</td><td>${formatCurrency(eqDepn)}</td></tr>
                            <tr><td>Indirect labor</td><td>${formatCurrency(indLabor * machLab)}</td><td>${formatCurrency(indLabor * setupLab)}</td><td>${formatCurrency(indLabor * otherLab)}</td><td>${formatCurrency(indLabor)}</td></tr>
                            <tr><td><strong>Total</strong></td><td><strong>${formatCurrency(machTotal)}</strong></td><td>${formatCurrency(setupTotal)}</td><td>${formatCurrency(otherTotal)}</td><td>${formatCurrency(eqDepn + indLabor)}</td></tr>
                        </table><br>
                        <strong>Answer: ${formatCurrency(machTotal)}</strong>`
                    };
                }
            },
            // Q37
            {
                type: 'short_answer_calc',
                generate: function() {
                    const d = currentExamData.q36 || {};
                    return {
                        question: `<strong>Question 37:</strong> Calculate activity rates for each activity cost pool using activity-based costing.`,
                        answer: `<table class="data-table">
                            <tr><th>Activity Cost Pool</th><th>Total Cost</th><th>Total Activity</th><th>Activity Rate</th></tr>
                            <tr><td>Machining</td><td>${formatCurrency(d.machTotal || 18200)}</td><td>${formatNumber(d.totalMH || 10000)} MHs</td><td><strong>$${(d.machRate || 1.82).toFixed(2)} per MH</strong></td></tr>
                            <tr><td>Setting up</td><td>${formatCurrency(d.setupTotal || 45000)}</td><td>${d.totalBatches || 1000} batches</td><td><strong>$${(d.setupRate || 45).toFixed(2)} per batch</strong></td></tr>
                        </table>`
                    };
                }
            },
            // Q38
            {
                type: 'short_answer_calc',
                generate: function() {
                    const d = currentExamData.q36 || {};
                    const machCost = (d.machRate || 1.82) * (d.c0MH || 6300);
                    const setupCost = (d.setupRate || 45) * (d.c0Batches || 400);
                    const total = machCost + setupCost;
                    
                    return {
                        question: `<strong>Question 38:</strong> Determine the amount of overhead cost that would be assigned to Product C0 using activity-based costing.`,
                        answer: `<table class="data-table">
                            <tr><th></th><th>Activity Rate</th><th>Activity</th><th>ABC Cost</th></tr>
                            <tr><td>Machining</td><td>$${(d.machRate || 1.82).toFixed(2)} per MH</td><td>${formatNumber(d.c0MH || 6300)} MHs</td><td>${formatCurrency(Math.round(machCost))}</td></tr>
                            <tr><td>Setting up</td><td>$${(d.setupRate || 45).toFixed(2)} per batch</td><td>${d.c0Batches || 400} batches</td><td>${formatCurrency(Math.round(setupCost))}</td></tr>
                            <tr><td colspan="3"><strong>Total</strong></td><td><strong>${formatCurrency(Math.round(total))}</strong></td></tr>
                        </table><br>
                        <strong>Answer: ${formatCurrency(Math.round(total))}</strong>`
                    };
                }
            }
        ];

        function generateExam() {
            answersVisible = false;
            currentExamData = {};
            
            const container = document.getElementById('examContent');
            let html = '';
            
            questions.forEach((q, index) => {
                const data = q.generate();
                
                if (q.type === 'conceptual' || q.type === 'calculation') {
                    html += `
                        <div class="question">
                            <span class="question-number">${index + 1}.</span>
                            <div class="question-text">${data.question}</div>
                            <div class="options">
                    `;
                    
                    data.options.forEach((opt, optIndex) => {
                        const letter = String.fromCharCode(65 + optIndex);
                        html += `
                            <label class="option" id="q${index}_opt${optIndex}">
                                <input type="radio" name="q${index}" value="${optIndex}" data-correct="${opt.correct}" onclick="selectOption(${index}, ${optIndex})">
                                <span class="option-text"><strong>${letter}.</strong> ${opt.text}</span>
                            </label>
                        `;
                    });
                    
                    const correctLetter = String.fromCharCode(65 + data.options.findIndex(o => o.correct));
                    html += `
                            </div>
                            <div class="answer" id="answer${index}">
                                <span class="answer-label">‚úì Correct Answer: ${correctLetter}</span>
                                <div class="explanation">${data.explanation}</div>
                            </div>
                        </div>
                    `;
                } else {
                    // Short answer questions
                    html += `
                        <div class="question">
                            <div class="question-text">${data.question}</div>
                            <div class="answer" id="answer${index}">
                                <span class="answer-label">‚úì Answer:</span>
                                <div class="explanation">${data.answer}</div>
                            </div>
                        </div>
                    `;
                }
            });
            
            container.innerHTML = html;
            
            // Add submit section after exam content
            const submitSection = document.createElement('div');
            submitSection.className = 'submit-section';
            submitSection.id = 'submitSection';
            submitSection.innerHTML = `
                <h3>Ready to Submit?</h3>
                <p>Review your answers before submitting. Once submitted, you'll see your grade and which questions you got right or wrong.</p>
                <button class="submit-btn" onclick="submitExam()">üìä Submit & Grade Exam</button>
                <div class="grade-result" id="gradeResult">
                    <div class="grade-percentage" id="gradePercentage">0%</div>
                    <div class="grade-letter" id="gradeLetter">F</div>
                    <div class="grade-details" id="gradeDetails">0/34 multiple choice correct</div>
                    <div class="unanswered-warning" id="unansweredWarning"></div>
                </div>
            `;
            container.appendChild(submitSection);
            
            document.getElementById('scoreDisplay').classList.remove('show');
        }

        function selectOption(questionIndex, optionIndex) {
            // Remove selected class from all options for this question
            const options = document.querySelectorAll(`[id^="q${questionIndex}_opt"]`);
            options.forEach(opt => opt.classList.remove('selected'));
            
            // Add selected class to chosen option
            document.getElementById(`q${questionIndex}_opt${optionIndex}`).classList.add('selected');
        }

        function submitExam() {
            let correct = 0;
            let answered = 0;
            const totalMC = 34; // Questions 1-34 are multiple choice
            
            // Grade only the multiple choice questions (first 34)
            for (let i = 0; i < totalMC; i++) {
                const selected = document.querySelector(`input[name="q${i}"]:checked`);
                const options = document.querySelectorAll(`[id^="q${i}_opt"]`);
                
                // Remove previous grading styles
                options.forEach(opt => {
                    opt.classList.remove('correct', 'incorrect');
                });
                
                if (selected) {
                    answered++;
                    const isCorrect = selected.getAttribute('data-correct') === 'true';
                    const selectedLabel = selected.closest('.option');
                    
                    if (isCorrect) {
                        correct++;
                        selectedLabel.classList.add('correct');
                    } else {
                        selectedLabel.classList.add('incorrect');
                        // Highlight the correct answer
                        options.forEach(opt => {
                            const input = opt.querySelector('input');
                            if (input && input.getAttribute('data-correct') === 'true') {
                                opt.classList.add('correct');
                            }
                        });
                    }
                } else {
                    // Question not answered - highlight correct answer
                    options.forEach(opt => {
                        const input = opt.querySelector('input');
                        if (input && input.getAttribute('data-correct') === 'true') {
                            opt.classList.add('correct');
                        }
                    });
                }
            }
            
            const percentage = Math.round((correct / totalMC) * 100);
            let letterGrade;
            
            if (percentage >= 93) letterGrade = 'A';
            else if (percentage >= 90) letterGrade = 'A-';
            else if (percentage >= 87) letterGrade = 'B+';
            else if (percentage >= 83) letterGrade = 'B';
            else if (percentage >= 80) letterGrade = 'B-';
            else if (percentage >= 77) letterGrade = 'C+';
            else if (percentage >= 73) letterGrade = 'C';
            else if (percentage >= 70) letterGrade = 'C-';
            else if (percentage >= 67) letterGrade = 'D+';
            else if (percentage >= 63) letterGrade = 'D';
            else if (percentage >= 60) letterGrade = 'D-';
            else letterGrade = 'F';
            
            // Update grade display
            document.getElementById('gradePercentage').textContent = `${percentage}%`;
            document.getElementById('gradeLetter').textContent = `Grade: ${letterGrade}`;
            document.getElementById('gradeDetails').textContent = `${correct}/${totalMC} multiple choice questions correct`;
            
            const gradeResult = document.getElementById('gradeResult');
            gradeResult.classList.remove('failing');
            if (percentage < 70) {
                gradeResult.classList.add('failing');
            }
            
            const unansweredCount = totalMC - answered;
            if (unansweredCount > 0) {
                document.getElementById('unansweredWarning').textContent = `‚ö†Ô∏è ${unansweredCount} question(s) left unanswered`;
            } else {
                document.getElementById('unansweredWarning').textContent = '‚úì All questions answered';
            }
            
            gradeResult.classList.add('show');
            
            // Show all answers
            answersVisible = true;
            const answers = document.querySelectorAll('.answer');
            answers.forEach(answer => answer.classList.add('show'));
            
            // Scroll to grade result
            gradeResult.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function checkAnswer(input, questionIndex) {
            // Visual feedback could be added here
        }

        function toggleAnswers() {
            answersVisible = !answersVisible;
            const answers = document.querySelectorAll('.answer');
            answers.forEach(answer => {
                if (answersVisible) {
                    answer.classList.add('show');
                } else {
                    answer.classList.remove('show');
                }
            });
        }

        // Generate exam on page load
        generateExam();
    </script>
</body>
</html>
